import"./modulepreload-polyfill-ec808ebb.js";import{S as Z,i as ee,s as te,e as w,a as k,b as G,c as x,d as h,f as v,l as A,n as J,g as _,o as ne,h as se,t as M,j as O}from"./index-c9542073.js";function B(u,e,r){const a=u.slice();return a[8]=e[r],a}function le(u){let e,r,a;return{c(){e=w("h1"),e.textContent="done",r=k(),a=w("h2"),a.textContent="ðŸŽ‰ðŸŽ‰ðŸŽ‰"},m(o,n){h(o,e,n),h(o,r,n),h(o,a,n)},p:J,d(o){o&&_(e),o&&_(r),o&&_(a)}}}function oe(u){let e,r,a,o,n=u[2](u[0].shownSession.startTime)+"",f,p,s,i=u[0].shownSession.name+"",c,t,l,m,T;return{c(){e=w("h1"),e.textContent="current session",r=k(),a=w("h2"),o=M("started at "),f=M(n),p=k(),s=w("h1"),c=M(i),t=k(),l=w("button"),l.textContent="done"},m(d,S){h(d,e,S),h(d,r,S),h(d,a,S),v(a,o),v(a,f),h(d,p,S),h(d,s,S),v(s,c),h(d,t,S),h(d,l,S),m||(T=A(l,"click",u[5]),m=!0)},p(d,S){S&1&&n!==(n=d[2](d[0].shownSession.startTime)+"")&&O(f,n),S&1&&i!==(i=d[0].shownSession.name+"")&&O(c,i)},d(d){d&&_(e),d&&_(r),d&&_(a),d&&_(p),d&&_(s),d&&_(t),d&&_(l),m=!1,T()}}}function ie(u){let e,r,a,o=u[3](u[0].shownSession)+"",n,f,p,s=u[0].shownSessionType==="next*"&&E(u);return{c(){e=w("h1"),e.textContent="next session",r=k(),a=w("h2"),n=M(o),f=k(),s&&s.c(),p=G()},m(i,c){h(i,e,c),h(i,r,c),h(i,a,c),v(a,n),h(i,f,c),s&&s.m(i,c),h(i,p,c)},p(i,c){c&1&&o!==(o=i[3](i[0].shownSession)+"")&&O(n,o),i[0].shownSessionType==="next*"?s?s.p(i,c):(s=E(i),s.c(),s.m(p.parentNode,p)):s&&(s.d(1),s=null)},d(i){i&&_(e),i&&_(r),i&&_(a),i&&_(f),s&&s.d(i),i&&_(p)}}}function E(u){let e,r,a;return{c(){e=w("button"),e.textContent="start"},m(o,n){h(o,e,n),r||(a=A(e,"click",u[4]),r=!0)},p:J,d(o){o&&_(e),r=!1,a()}}}function F(u){let e,r,a,o=u[0].history,n=[];for(let f=0;f<o.length;f+=1)n[f]=U(B(u,o,f));return{c(){e=w("div"),r=w("div"),r.textContent="â†“",a=k();for(let f=0;f<n.length;f+=1)n[f].c();x(r,"class","scroll svelte-1tkjip9"),x(e,"class","prev svelte-1tkjip9")},m(f,p){h(f,e,p),v(e,r),v(e,a);for(let s=0;s<n.length;s+=1)n[s].m(e,null)},p(f,p){if(p&5){o=f[0].history;let s;for(s=0;s<o.length;s+=1){const i=B(f,o,s);n[s]?n[s].p(i,p):(n[s]=U(i),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=o.length}},d(f){f&&_(e),se(n,f)}}}function U(u){let e,r=u[8].name+"",a,o,n=u[8].startDate+"",f,p,s=u[2](u[8].startTime)+"",i;return{c(){e=w("div"),a=M(r),o=k(),f=M(n),p=k(),i=M(s)},m(c,t){h(c,e,t),v(e,a),v(e,o),v(e,f),v(e,p),v(e,i)},p(c,t){t&1&&r!==(r=c[8].name+"")&&O(a,r),t&1&&n!==(n=c[8].startDate+"")&&O(f,n),t&1&&s!==(s=c[2](c[8].startTime)+"")&&O(i,s)},d(c){c&&_(e)}}}function ae(u){let e,r,a,o,n,f,p;function s(l,m){return l[0].shownSessionType==="next"||l[0].shownSessionType==="next*"?ie:l[0].shownSessionType==="curr"?oe:le}let i=s(u),c=i(u),t=u[0].history.length>0&&F(u);return{c(){e=w("div"),c.c(),r=k(),a=w("button"),a.textContent="ðŸ“‹ ðŸ”—",o=k(),t&&t.c(),n=G(),x(a,"class","copy svelte-1tkjip9"),x(e,"class","screen svelte-1tkjip9")},m(l,m){h(l,e,m),c.m(e,null),v(e,r),v(e,a),h(l,o,m),t&&t.m(l,m),h(l,n,m),f||(p=A(a,"click",u[6]),f=!0)},p(l,[m]){i===(i=s(l))&&c?c.p(l,m):(c.d(1),c=i(l),c&&(c.c(),c.m(e,r))),l[0].history.length>0?t?t.p(l,m):(t=F(l),t.c(),t.m(n.parentNode,n)):t&&(t.d(1),t=null)},i:J,o:J,d(l){l&&_(e),c.d(),l&&_(o),t&&t.d(l),l&&_(n),f=!1,p()}}}function re(u,e,r){const a=(t,l)=>{const T=Number.parseInt(t.split("-").join("")+l.toString().padStart(3,"0"))*15485863;return T*T*T%2038074743/2038074743},o=()=>{const[t,l,m,T,d]=JSON.parse(localStorage.getItem("data")),S=m.length*l,$=new Date().toISOString(),C=$.slice(0,10),[K,L]=$.slice(11,16).split(":").map(y=>Number.parseInt(y)),H=K*12+L/5,Q=new Date(t).getTime(),W=new Date(C).getTime(),P=Math.round((W-Q)/864e5);let R=m.length-1;for(const[y,D]of m.entries())if(H<=D){R=y-1;break}const I=Math.max(-1,P*m.length+R),X=I===-1?-277:m[I%m.length],N=I+1,Y=N===m.length?555:m[N%m.length];let b,g;P<0?(b=N,g="next"):Y-H<=6?(b=N,d>=N?g="curr":g="next*"):H-X>72||d>I?(b=N,g="next"):d===I?(b=I,g="curr"):(b=I,g="next*"),b>=S&&(b=S,g="done");const q=Object.entries(T).sort(([y],[D])=>y==="nothing"?1:D==="nothing"?-1:0).flatMap(([y,D])=>new Array(D).fill(y)),j=[];for(let y=0;y<l;y++){const D=new Date(new Date(t).getTime()+864e5*y+432e5).toISOString().slice(0,10);for(let V of m){let z=a(D,V);y===0&&V===m[0]&&(z=Math.min(z,.49)),j.push({i:j.length,startDate:D,startTime:V,name:q.splice(Math.floor(z*q.length),1)[0]})}}return{shownSession:j[b],shownSessionType:g,shouldShowSession:d<b,history:j.slice(0,b).reverse()}},n=t=>`${`${Math.floor(t/12)}`.padStart(2,"0")}:${`${5*t%12}`.padStart(2,"0")}`,f=t=>{const l=new Date().toISOString(),[m,T]=l.slice(11,16).split(":").map(C=>Number.parseInt(C)),d=m*12+T/5,S=l.slice(0,10),$=new Date(Date.now()+864e5).toISOString().slice(0,10);if(t.startDate===S){const C=Math.round(5*(t.startTime-d));return C<=0?"now":`in ${C} mins (${n(t.startTime)})`}else return t.startDate===$?`tomorrow at ${n(t.startTime)}`:`on ${t.startDate} at ${n(t.startTime)}`};let p=o();return ne(async()=>{for(;;)await new Promise(t=>{setTimeout(()=>{t()},61e3-Date.now()%6e4)}),r(0,p=o())}),[p,o,n,f,()=>{const t=JSON.parse(localStorage.getItem("data"));t[4]=p.shownSession.i,localStorage.setItem("data",JSON.stringify(t)),r(0,p=o())},()=>{const t=JSON.parse(localStorage.getItem("data"));t[4]=p.shownSession.i+.5,localStorage.setItem("data",JSON.stringify(t)),r(0,p=o())},t=>{const l=t.currentTarget;navigator.clipboard.writeText(window.location.origin+"/revision-app/load.html?x="+btoa(encodeURIComponent(localStorage.getItem("data")))).then(()=>{l.innerText="copied link",l.style.lineHeight="16px",l.style.fontSize="14px",l.style.padding="4px",l.style.color="#fff",setTimeout(()=>{l.innerText="ðŸ“‹ ðŸ”—",l.style.lineHeight="",l.style.fontSize="",l.style.color="",l.style.padding=""},1e3)}).catch(()=>{})}]}class fe extends Z{constructor(e){super(),ee(this,e,re,ae,te,{})}}localStorage.getItem("data")||(window.location.href="/revision-app/setup.html");new fe({target:document.getElementById("app")});
